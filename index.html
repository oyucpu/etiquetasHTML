<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="estilos.css">
    <title>HTML 2025 - Referencia Completa</title>
    <style>
        /* Pequeños retoques visuales rápidos (opcional, puedes borrarlos si ya tienes en estilos.css) */
        .ns { color: #666; font-size: 0.8em; margin-left: 6px; }
        .stats { margin: 20px 0; font-weight: bold; }
        .total-highlight { color: #0066cc; font-size: 1.3em; }
        h1 span { color: #0066cc; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Referencia HTML 2025 – <span id="dynamicTotal">0</span> entradas</h1>
            <p>HTML + SVG + MathML • Con atributos, estado experimental y obsolescencia</p>
        </header>

        <div class="controls">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Buscar etiqueta, atributo, descripción o namespace (html/svg/mathml)...">
            </div>
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">Todas</button>
                <button class="filter-btn" data-filter="current">Vigentes</button>
                <button class="filter-btn experimental" data-filter="experimental">Experimentales</button>
                <button class="filter-btn obsolete" data-filter="obsolete">Obsoletas</button>
            </div>
        </div>

        <div class="content">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalTags">0</div>
                    <div>Total entradas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="uniqueTags">0</div>
                    <div>Etiquetas únicas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="currentTags">0</div>
                    <div>Vigentes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="experimentalTags">0</div>
                    <div>Experimentales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="obsoleteTags">0</div>
                    <div>Obsoletas</div>
                </div>
            </div>

            <div class="tag-grid" id="tagGrid"></div>
            <div class="no-results" id="noResults">
                <h3>No hay resultados</h3>
                <p>Prueba con otro término o quita filtros</p>
            </div>
        </div>
    </div>

    <script src="array.js"></script>

    <script>
        const tagGrid = document.getElementById("tagGrid");
        const searchInput = document.getElementById("searchInput");
        const noResults = document.getElementById("noResults");

        function createBadge(text, className) {
            return `<span class="badge ${className}">${text}</span>`;
        }

        function renderTags(tags) {
            tagGrid.innerHTML = "";
            if (tags.length === 0) {
                noResults.style.display = "block";
                return;
            }
            noResults.style.display = "none";

            tags.forEach(tag => {
                const card = document.createElement("div");
                let cardClass = "tag-card";
                if (tag.obs) cardClass += " obsolete";
                if (tag.exp) cardClass += " experimental";
                card.className = cardClass;

                let badges = "";
                if (tag.obs) badges += createBadge("Obsoleta", "obsolete");
                if (tag.exp) badges += createBadge("Experimental", "experimental");
                if (tag.global) badges += createBadge("Atributos globales", "global");

                let attrsHTML = "";
                if (tag.attrs && tag.attrs.length > 0) {
                    attrsHTML = `
                        <div class="attributes-section">
                            <div class="attributes-title">Atributos específicos</div>
                            ${tag.attrs.map(a => {
                                const isObs = /\s*\(?obs?\)?$/i.test(a);
                                const clean = a.replace(/\s*\(?obs?\)?$/i, "").trim();
                                return `<span class="attribute ${isObs ? "obsolete" : ""}">${clean}</span>`;
                            }).join("")}
                        </div>`;
                }

                const nsLabel = tag.ns ? `<small class="ns">(${tag.ns.toUpperCase()})</small>` : "";

                card.innerHTML = `
                    <div class="tag-header">
                        <div class="tag-name">&lt;${tag.name}&gt; ${nsLabel}</div>
                        <div class="badges">${badges}</div>
                    </div>
                    <div class="tag-description">${tag.desc}</div>
                    ${attrsHTML}
                `;
                tagGrid.appendChild(card);
            });
        }

        function updateStats() {
            const total = htmlTags.length;
            const unique = new Set(htmlTags.map(t => t.ns ? `${t.name}|${t.ns}` : t.name)).size;

            const current = htmlTags.filter(t => !t.obs && !t.exp).length;
            const experimental = htmlTags.filter(t => t.exp).length;
            const obsolete = htmlTags.filter(t => t.obs).length;

            document.getElementById("totalTags").textContent = total;
            document.getElementById("uniqueTags").textContent = unique;
            document.getElementById("currentTags").textContent = current;
            document.getElementById("experimentalTags").textContent = experimental;
            document.getElementById("obsoleteTags").textContent = obsolete;

            // Actualiza el título de la página y el h1
            document.getElementById("dynamicTotal").textContent = total;
            document.title = `HTML 2025 - Referencia Completa (${total} entradas)`;
        }

        function filterTags() {
            const query = searchInput.value.toLowerCase().trim();
            const active = document.querySelector(".filter-btn.active")?.dataset.filter || "all";

            const filtered = htmlTags.filter(tag => {
                // Filtros por botón
                if (active === "current" && (tag.obs || tag.exp)) return false;
                if (active === "obsolete" && !tag.obs) return false;
                if (active === "experimental" && !tag.exp) return false;

                // Búsqueda
                if (!query) return true;
                const searchIn = `${tag.ns || ""} ${tag.name} ${tag.desc} ${tag.attrs?.join(" ") || ""}`.toLowerCase();
                return searchIn.includes(query);
            });

            renderTags(filtered);
            updateStats(); // las estadísticas siempre reflejan el array completo
        }

        // Eventos
        searchInput.addEventListener("input", filterTags);
        document.querySelectorAll(".filter-btn").forEach(btn => {
            btn.addEventListener("click", () => {
                document.querySelectorAll(".filter-btn").forEach(b => b.classList.remove("active"));
                btn.classList.add("active");
                filterTags();
            });
        });

        // Inicio
        updateStats();
        renderTags(htmlTags);
    </script>
</body>
</html>